---
title: "BF591 Final Project Data Analysis"
author: "Caroline Sullivan"
date: "2023-04-18"
output: html_document
---

```{r setup, include=FALSE}
source("analysis.R")
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r getting metadata}
meta <- get_md()
meta_filtered <- filter_md(meta)
head(meta_filtered)
```
```{r summarizing metadata}
meta_summary <- summarize_md(meta_filtered)
meta_summary
```
```{r visualizing metadata}
barplot <- visualize_md(meta_filtered, 'Lifestage', 'Timepoint')
barplot
```

```{r prep counts data}
counts <- get_data(meta)

male_counts = counts[1][[1]]
female_counts = counts[2][[1]]
larvae_counts = counts[3][[1]]

head(female_counts)

```


```{r DESeq2}
deseq_results_male <- run_deseq(male_counts, get_col_data(male_counts, meta), 
                                10, "condition_fluctuating_vs_control")

deseq_results_female <- run_deseq(female_counts, get_col_data(female_counts, meta),
                                  10, "condition_fluctuating_vs_control")

deseq_results_larvae <- run_deseq(larvae_counts, get_col_data(larvae_counts, meta), 
                                 10, "condition_fluctuating_vs_control")

```

```{r DESeq2 results}
head(deseq_results_larvae)
```
```{r DESeq2 comparison}

gene_names <- list(Male = de_genes(deseq_results_male), 
                   Female = de_genes(deseq_results_female), 
                   Larvae = de_genes(deseq_results_larvae))

ggVennDiagram(x=gene_names) +
  ggtitle('Differentially Expressed Transcripts fluctuating vs. control') #+
   #scale_x_continuous(expand = expansion(mult = .2))

```
